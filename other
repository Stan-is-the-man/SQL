SELECT customer_id, SUM(amount)
FROM payment
GROUP BY customer_id
HAVING SUM(amount) < 37
ORDER BY customer_id DESC;

SELECT staff_id, COUNT(amount)
FROM payment
GROUP BY staff_id
ORDER BY staff_id DESC
LIMIT 1

SELECT rating, ROUND(AVG(replacement_cost),2)
FROM film
GROUP BY rating
ORDER BY AVG(replacement_cost);

SELECT COUNT(DISTINCT(customer_id))
FROM payment

SELECT customer_id, ord_date, MAX(purch_amt)
FROM orders
GROUP BY customer_id, ord_date
HAVING MAX(purch_amt) IN (2000, 3000, 5760,6000)
ORDER BY MAX(purch_amt) DESC
